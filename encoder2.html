<!DOCTYPE html>
<html>
<head>
  <script>
    function encodeLatex() {
      let urlParams = new URLSearchParams(window.location.search);
      let latex = urlParams.get("latex");

      if (!latex) {
        console.log("❌ Error: No se encontró el parámetro 'latex'.");
        return;
      }

      // Agregar dpi para aumentar la resolución
      let highResLatex = "\\dpi{300} " + latex;

      // Codificar correctamente el signo "+"
      let encodedLatex = encodeURIComponent(highResLatex).replace(/\+/g, "%2B");

      // Generar la URL de la imagen con alta resolución
      let imgUrl = "https://latex.codecogs.com/png.latex?" + encodedLatex;

      console.log("✅ URL de la imagen (alta resolución):", imgUrl);

      // Enviar SOLO la URL de la imagen a Thunkable
      setTimeout(function () {
        if (window.ReactNativeWebView) {
          window.ReactNativeWebView.postMessage(imgUrl);
        } else if (window.parent) {
          window.parent.postMessage(imgUrl, "*");
        }
      }, 500);
    }

    window.onload = encodeLatex;
  </script>
</head>
<body>
</body>
</html>
