<!DOCTYPE html>
<html>
<head>
  <script>
    function encodeLatex() {
      let urlParams = new URLSearchParams(window.location.search);
      let latex = urlParams.get("latex");

      if (!latex) {
        console.log("‚ùå Error: No se encontr√≥ el par√°metro 'latex'.");
        return;
      }

      // üîπ Codificar caracteres especiales correctamente para evitar errores
      let encodedLatex = encodeURIComponent(latex)
        .replace(/\+/g, "%2B")  // Corregir el signo "+"
        .replace(/=/g, "%3D")   // Corregir "="
        .replace(/&/g, "%26")   // Corregir "&"
        .replace(/\{/g, "%7B")  // Corregir "{"
        .replace(/\}/g, "%7D")  // Corregir "}"
        .replace(/\\/g, "%5C"); // Corregir "\"

      // üîπ Generar URL en SVG con fondo blanco
      let imgUrl = "https://latex.codecogs.com/svg.latex?\\bg_white " + encodedLatex;

      console.log("‚úÖ URL de la imagen generada:", imgUrl);

      // üîπ Enviar la URL de la imagen a Thunkable
      if (window.ReactNativeWebView) {
        window.ReactNativeWebView.postMessage(imgUrl);
      } else if (window.parent) {
        window.parent.postMessage(imgUrl, "*");
      }
    }

    window.onload = encodeLatex;
  </script>
</head>
<body>
</body>
</html>
