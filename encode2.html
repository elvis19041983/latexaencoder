<!DOCTYPE html>
<html>
<head>
  <script>
    function encodeLatex() {
      let urlParams = new URLSearchParams(window.location.search);
      let latex = urlParams.get("latex");

      if (!latex) {
        document.getElementById("output").innerText = "❌ Error: No se encontró el parámetro 'latex'.";
        return;
      }

      // Asegurar que los signos + y espacios se codifiquen correctamente
      let encodedLatex = encodeURIComponent(latex)
        .replace(/\+/g, "%2B")  // Codifica el signo +
        .replace(/%20/g, "%5C ");  // Asegurar espacios correctos en LaTeX

      let imgUrl = "https://latex.codecogs.com/png.latex?" + encodedLatex;

      // Mostrar la URL en la consola para depuración
      console.log("URL de la imagen:", imgUrl);

      // Mostrar la URL en pantalla para verificar
      document.getElementById("output").innerText = "✅ URL generada: " + imgUrl;

      // Asignar la URL al <img>
      let imgElement = document.getElementById("latexImage");
      imgElement.src = imgUrl;

      // Manejo de error en caso de que la imagen no cargue
      imgElement.onerror = function () {
        document.getElementById("output").innerText = "❌ Error al cargar la imagen.";
      };
    }

    window.onload = encodeLatex;
  </script>
</head>
<body>
  <h2>Prueba de `encoder2.html`</h2>
  <p id="output">⌛ Generando imagen...</p>
  <img id="latexImage" alt="Imagen LaTeX no generada aún" style="border: 1px solid black; max-width: 100%;" />
</body>
</html>
