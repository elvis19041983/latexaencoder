<!DOCTYPE html>
<html>
<head>
  <script>
    function encodeLatex() {
      let urlParams = new URLSearchParams(window.location.search);
      let latex = urlParams.get("latex");

      if (latex) {
        let encodedLatex = encodeURIComponent(latex);
        document.getElementById("output").innerText = encodedLatex;

        console.log("Encoded LaTeX:", encodedLatex); // Verificar en la consola

        // Enviar mensaje a Thunkable
        function sendToThunkable() {
          if (window.ReactNativeWebView && window.ReactNativeWebView.postMessage) {
            window.ReactNativeWebView.postMessage(encodedLatex);
            console.log("Mensaje enviado a Thunkable con ReactNativeWebView:", encodedLatex);
          } else if (window.parent) {
            window.parent.postMessage(encodedLatex, "*");
            console.log("Mensaje enviado a Thunkable con window.parent.postMessage:", encodedLatex);
          } else {
            console.log("No se pudo enviar el mensaje, reintentando...");
            setTimeout(sendToThunkable, 500);
          }
        }

        sendToThunkable();
      } else {
        document.getElementById("output").innerText = "Error: No se encontró el parámetro 'latex'.";
      }
    }
  </script>
</head>
<body onload="encodeLatex()">
  <p id="output"></p>
</body>
</html>
